services:
  - type: web
    name: test-generator
    env: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .

    # Render asigna el puerto autom√°ticamente en $PORT
    # pero nuestro app usa 3000 por defecto
    envVars:
      - key: PORT
        value: 3000

      # Claude Code OAuth Token (Secret)
      - key: CLAUDE_CODE_OAUTH_TOKEN
        sync: false  # Configurar manualmente en Render Dashboard

      # SSH Bastion
      - key: SSH_HOST
        value: 3.216.195.253

      - key: SSH_USER
        value: ubuntu

      - key: SSH_PRIVATE_KEY
        sync: false  # Configurar manualmente como Secret

      # RDS Database
      - key: RDS_HOST
        sync: false  # Configurar manualmente

      - key: RDS_PORT
        value: 3306

      # MySQL Credentials
      - key: MYSQL_HOST
        value: 127.0.0.1  # Localhost porque usa SSH tunnel

      - key: MYSQL_PORT
        value: 3306

      - key: MYSQL_USER
        sync: false  # Configurar manualmente

      - key: MYSQL_PASSWORD
        sync: false  # Configurar manualmente (como Secret)

      - key: MYSQL_DATABASE
        sync: false  # Configurar manualmente

      # ElevenLabs API Key
      - key: ELEVENLABS_API_KEY
        value: sk_4a549a662bf9b8d3773d2d753c14e9e3eb7d3f48d2f92104

      # Node Environment
      - key: NODE_ENV
        value: production

    # Health check
    healthCheckPath: /health

    # Persistent disk para SSH key (opcional)
    # Si prefieres no incluir el SSH key en la imagen
    # disk:
    #   name: ssh-keys
    #   mountPath: /home/appuser/.ssh
    #   sizeGB: 1
